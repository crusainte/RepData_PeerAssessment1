---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
- By Yang Yuzhong

The activity.csv contains a total of 17,568 observation of the variables:

- **steps**: Number of steps taking in a 5-minute interval (missing values are coded as NA)

- **date**: The date on which the measurement was taken in YYYY-MM-DD format

- **interval**: Identifier for the 5-minute interval in which measurement was taken

## Loading required R packages
Libraries required to perform the peer assessment is loaded.
Options in R environment are updated so that numbers >= 10^5 will be denoted in 
scientific notation (scipen = 1), and rounded to 2 digits (digits = 2). This
is to beautify subsequent numeric output in the peer assessment.
```{r loadpackages, echo=TRUE}
library(dplyr)
library(lubridate)
options(scipen = 1, digits = 2)
```

## Loading and preprocessing the data

activity.csv is first loaded using `read.csv()` function.

```{r loadingdata, echo=TRUE}
activity<-read.csv("activity.csv")
```

The format of the loaded table is then changed to the following with select 
function from dply:

| date | interval | steps |
| ---- | -------- | ----- |
| 2012-10-01 | 0 | NA |
| ... | ... | ... |

```{r preprocessdata, echo=TRUE}
activity<-activity %>% 
select(date,interval,steps)
```

## What is mean total number of steps taken per day?

To obtain the mean total number of steps taken per day, the total steps per day
is first calculated. This is done through `group_by()` _date_ then `summarize()` 
which performs the `sum()` function on each day.

```{r totalsteps,echo=TRUE}
dailytotalsteps <- activity %>% 
    group_by(date) %>% 
    summarize(steps = sum(steps,na.rm=TRUE))
```

The histogram shows the distribution of the total number of steps per day.

```{r histogram, echo=TRUE}
hist(dailytotalsteps$steps,
     breaks=10,
     col="lightskyblue",
     main="Total number of steps taken per day",
     xlab="Total steps per day",
     ylab="Percentage of total steps taken per day")
```

With the total number of steps taken per day, the mean and median is easily
calculated with the corresponding function.

```{r meanmedian, echo=TRUE}
meansteps<-mean(dailytotalsteps$steps)

mediansteps<-median(dailytotalsteps$steps)
```

| mean total steps per day | median total steps per day | 
| ---- | ------ | 
| `r meansteps` | `r mediansteps` | 

## What is the average daily activity pattern?

To obtain the average daily activity pattern, `group_by()` is first performed on
_interval_ then `mean()` of _steps_ are taken for each _interval_
```{r dailypattern, echo=TRUE}
dailypattern<-activity %>% 
    group_by(interval) %>% 
    summarize(steps = mean(steps,na.rm=TRUE))
```

In order to plot the time series for the average daily pattern, 
the column _interval_ from the dataset must be converted from numeric data type
to time type. 

Since the _interval_ encompasses 1 day in 5 minutes interval,
`seq.POSIXt()` was used to generate a time sequence by 5 minutes with 
`Sys.Date()` and `Sys.Date()+1` as the limis of the generated time sequence.
After the time sequence is generated, `format()` is used to extract the
hours and minutes that corresponds to the _interval_ column from the dataset.
```{r timeinterval, echo=TRUE}
mininterval<-as.POSIXct(Sys.Date())

maxinterval<-as.POSIXct(Sys.Date()+1)

dateinterval<-seq.POSIXt(mininterval, maxinterval, by = "5 min")

dateinterval<-format( dateinterval,"%H%M", tz="SGT")
```

With the time sequence generated and properly formatted, `mutate()` is used
to replace the current numeric _interval_ to the time based _interval_.
```{r mutatetime}
dailypattern<- dailypattern %>%
    mutate(interval=dateinterval[1:288])
```

Lastly, time series plot is achieved by plotting the time interval against 
steps with proper labels for the plot.
```{r timeseriesplot, echo=TRUE}
plot(dailypattern$interval,
     dailypattern$steps,type="l",
     main="Average Daily Activity Pattern",
     xlab="Daily Interval of 5 minutes",
     ylab="Average steps per interval")
```

The 5-minute interval, on average across all the days in the dataset, 
that contains the maximum number of steps is obtained using `which.max()`
and subsetting _interval_.
```{r maxinterval, echo=TRUE}
maxstepinterval<-dailypattern$interval[which.max(dailypattern$steps)]
```

The 5-minute interval with maximum number of steps is `r maxstepinterval`

## Imputing missing values

### 1) Total number of missing values in the dataset

```{r missingvalues, echo=TRUE}
num.na<-sum(is.na(activity$steps))
```

The total number of missing values in the dataset is `r num.na`

### 2) Strategy for filling in all missing values in dataset

1. Obtain the median of steps for each interval per day
```{r dailymedian, echo=TRUE}
dailymedian<-activity %>% 
    group_by(interval) %>% 
    summarize(mediansteps = median(steps,na.rm=TRUE))
```

2 & 3. Create new dataset _imputdata_ using `left_join()` to retain all rows
in the original dataset and to join with the daily median of steps across
the entire dataset. Lastly, replace the rows with _NA_ with daily median steps
for the corresponding interval.
```{r imputdata, echo=TRUE}
imputdata<- activity %>%
    left_join(dailymedian, by = "interval") %>%
    mutate(steps=ifelse(is.na(steps), mediansteps, steps))
```

4. Histogram of the total number of steps taken each day and the mean 
and median total number of steps taken per day.

## Are there differences in activity patterns between weekdays and weekends?
